<!DOCTYPE html>
<html>
 <head>
    <link href="../app.css" rel="stylesheet" />
    <script src="./MicrosoftTeams.min.js"></script>
   </head>

<body>
  
  <!-- The Error Modal -->
<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="errorMessage" class="error-message">Error</div>
    </div>
  
  </div>
  <script src="./app.js"></script>
  <h2>API using sdk as JS</h2>
  <div class="moduleContainer">
    <div>
      <div class="sectionTitle">openPurchaseExperience</div>
      <button onclick="openPurchaseExperience()">openPurchaseExperience</button>
    </div>
  </div>
  <script src="./app.js"></script>

  <script>
    function enablePrintCapability() {
      microsoftTeams.initialize();
      microsoftTeams.enablePrintCapability();
    }

    function authenticate() {
      microsoftTeams.initialize();
      microsoftTeams.authentication.authenticate({
            url: 'https://teams-test-tab.azurewebsites.net'
      });
    }

    function enableImplicitExecuteDeepLink() {
      microsoftTeams.initialize();
      microsoftTeams.enableImplicitExecuteDeepLink();
    }

    function printHandler() {
      microsoftTeams.print();
    }

    function openPurchaseExperience() {
      microsoftTeams.initialize();
      let callbackcalled = false;
      microsoftTeams.monetization.openPurchaseExperience((e) => {
        console.log("callback is being called");
        callbackcalled = true;  
        if (!!e && typeof e !== "string") {
          e = JSON.stringify(e);
          alert(e);
        }
        return;
      });
      console.log("after callback: ",callbackcalled);
    }
  </script>
</body>

</html>