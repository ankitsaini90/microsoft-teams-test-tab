<!DOCTYPE html>
<html>
 <head>
    <link href="../app.css" rel="stylesheet" />
    <script src="./MicrosoftTeams.min.js"></script>
   </head>

<body>
  
  <!-- The Error Modal -->
<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="errorMessage" class="error-message">Error</div>
    </div>
  
  </div>
  <script src="./app.js"></script>
  <div class="moduleContainer"></div>
    <div id="iapDiv">
      <button onclick="openPurchaseExperience()">openPurchaseExperience</button>
    </div>
  </div>
  <script src="./app.js"></script>

  <script>
    function openPurchaseExperience() {
      microsoftTeams.initialize();
      let callbackcalled = false;
      microsoftTeams.monetization.openPurchaseExperience((e) => {
        console.log("callback is being called");
        callbackcalled = true;  
        if (!!e && typeof e !== "string") {
          e = JSON.stringify(e);
          alert(e);
        }
        return;
      });
      console.log("after callback: ",callbackcalled);
    }

    function hideDiv(element) {
      if(element.value == "Show") {
        document.getElementById('iapDiv').style.visibility = "visible";
      } else {
        document.getElementById('iapDiv').style.visibility = "hidden";
      }
    }
  </script>
</body>

</html>